

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pyramid Match Kernel &mdash; GraKeL 0.1a7 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/_static/css/supplementary.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Random Walk Kernel" href="random_walk.html" />
    <link rel="prev" title="Propagation Kernel" href="propagation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GraKeL
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1a7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual.html">User Manual</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">GraKeL</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../kernels.html">Kernels (between graphs)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="core_framework.html">Core Kernel Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="edge_histogram.html">Edge Histogram Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="graph_hopper.html">Graph Hopper Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="graphlet_sampling.html">Graphlet Sampling Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="hadamard_code.html">Hadamard Code Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="kernel.html">Kernel (general class)</a></li>
<li class="toctree-l3"><a class="reference internal" href="lovasz_theta.html">Lovasz Theta Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiscale_laplacian.html">Multiscale Laplacian Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="neighborhood_hash.html">Neighborhood Hash Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="neighborhood_subgraph_pairwise_distance.html">Neighborhood Subgraph Pairwise Distance Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="odd_sth.html">ODD-STh Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="propagation.html">Propagation Kernel</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Pyramid Match Kernel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="random_walk.html">Random Walk Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="shortest_path.html">Shortest Path Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="subgraph_matching.html">Subgraph Matching Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="svm_theta.html">SVM Theta Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="vertex_histogram.html">Vertex Histogram Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="weisfeiler_lehman.html">Weisfeiler Lehman Framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../graph_kernel.html">GraphKernel (class)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../graph.html">Graph (class)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datasets.html">Dataset loading utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GraKeL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api.html">GraKeL</a> &raquo;</li>
        
          <li><a href="../kernels.html">Kernels (between graphs)</a> &raquo;</li>
        
      <li>Pyramid Match Kernel</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/kernels/pyramid_match.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pyramid-match-kernel">
<span id="pyramid-match"></span><h1>Pyramid Match Kernel<a class="headerlink" href="#pyramid-match-kernel" title="Permalink to this headline">¶</a></h1>
<p>The pyramid match kernel is a very popular algorithm in Computer Vision, and has proven useful for many applications including object recognition and image retrieval <a class="reference internal" href="#grauman2007pyramid" id="id1">[grauman2007pyramid]</a>, <a class="reference internal" href="#lazebnik2006beyond" id="id2">[lazebnik2006beyond]</a>.
The pyramid match graph kernel extends its applicability to graph-structured data <a class="reference internal" href="#nikolentzos2017matching" id="id3">[nikolentzos2017matching]</a>.
The kernel can handle both unlabeled graphs and graphs that contains discrete node labels.</p>
<p>The pyramid match graph kernel first embedds the vertices of each graph into a low-dimensional vector space using the eigenvectors of the <span class="math notranslate nohighlight">\(d\)</span> largest in magnitude eigenvalues of the adjacency matrix of the graph.
Since the signs of these eigenvectors are arbitrary, it replaces all their components by their absolute values.
Each vertex is thus a point in the <span class="math notranslate nohighlight">\(d\)</span>-dimensional unit hypercube.
To find an approximate correspondence between the sets of vertices of two graphs, the kernel maps these points to multi-resolution histograms, and compares the emerging histograms with a weighted histogram intersection function.</p>
<p>Initially, the kernel partitions the feature space into regions of increasingly larger size and takes a weighted sum of the matches that occur at each level.
Two points match with each other if they fall into the same region.
Matches made within larger regions are weighted less than those found in smaller regions.
The kernel repeatedly fits a grid with cells of increasing size to the <span class="math notranslate nohighlight">\(d\)</span>-dimensional unit hypercube.
Each cell is related only to a specific dimension and its size along that dimension is doubled at each iteration, while its size along the other dimensions stays constant and equal to <span class="math notranslate nohighlight">\(1\)</span>.
Given a sequence of levels from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(L\)</span>, then at level <span class="math notranslate nohighlight">\(l\)</span>, the <span class="math notranslate nohighlight">\(d\)</span>-dimensional unit hypercube has <span class="math notranslate nohighlight">\(2^l\)</span> cells along each dimension and <span class="math notranslate nohighlight">\(D = 2^{l}d\)</span> cells in total.
Given a pair of graphs <span class="math notranslate nohighlight">\(G,G'\)</span>, let <span class="math notranslate nohighlight">\(H_G^l\)</span> and <span class="math notranslate nohighlight">\(H_{G'}^l\)</span> denote the histograms of <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(G'\)</span> at level <span class="math notranslate nohighlight">\(l\)</span> and <span class="math notranslate nohighlight">\(H_G^l(i)\)</span>, <span class="math notranslate nohighlight">\(H_{G'}^l(i)\)</span>, the number of vertices of <span class="math notranslate nohighlight">\(G\)</span>, <span class="math notranslate nohighlight">\(G'\)</span> that lie in the <span class="math notranslate nohighlight">\(i^{th}\)</span> cell.
The number of points in two sets which match at level $l$ is then computed using the histogram intersection function</p>
<div class="math notranslate nohighlight">
\[I(H_G^l,H_{G'}^l) = \sum_{i=1}^D \min\big(H_G^l(i),H_{G'}^l(i)\big)\]</div>
<p>The matches that occur at level <span class="math notranslate nohighlight">\(l\)</span> also occur at levels <span class="math notranslate nohighlight">\(0, \ldots, l-1\)</span>.
We are interested in the number of new matches found at each level which is given by <span class="math notranslate nohighlight">\(I(H_{G_1}^l,H_{G_2}^l) - I(H_{G_1}^{l+1},H_{G_2}^{l+1})\)</span> for <span class="math notranslate nohighlight">\(l=0,\ldots,L-1\)</span>.
The number of new matches found at each level in the pyramid is weighted according to the size of that level’s cells.
Matches found within smaller cells are weighted more than those made in larger cells.
Specifically, the weight for level <span class="math notranslate nohighlight">\(l\)</span> is set equal to <span class="math notranslate nohighlight">\(\frac{1}{2^{L-l}}\)</span>.
Hence, the weights are inversely proportional to the length of the side of the cells that varies in size as the levels increase.
The pyramid match kernel is then defined as follows</p>
<div class="math notranslate nohighlight">
\[k(G,G') = I(H_G^L,H_{G'}^L) + \sum_{l=0}^{L-1} \frac{1}{2^{L-l}}\big(I(H_G^l,H_{G'}^l) - I(H_G^{l+1},H_{G'}^{l+1})\big)\]</div>
<p>The complexity of the pyramid match kernel is <span class="math notranslate nohighlight">\(\mathcal{O}(dnL)\)</span> where $n$ is the number of nodes of the graphs under comparison.</p>
<p>In the case of labeled graphs, the kernel restricts matchings to occur only between vertices that share same labels.
It represents each graph as a set of sets of vectors, and matches pairs of sets of two graphs corresponding to the same label using the pyramid match kernel.
The emerging kernel for labeled graphs corresponds to the sum of the separate kernels</p>
<div class="math notranslate nohighlight">
\[k(G, G') = \sum_{i=1}^c k^i(G,G')\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the number of distinct labels and <span class="math notranslate nohighlight">\(k^i(G_1,G_2)\)</span> is the pyramid match kernel between the sets of vertices of the two graphs which are assigned the label <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>The above kernel is implemented below</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../generated/grakel.PyramidMatch.html#grakel.PyramidMatch" title="grakel.PyramidMatch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyramidMatch</span></code></a>([n_jobs,&nbsp;normalize,&nbsp;verbose,&nbsp;…])</td>
<td>Pyramid match kernel class.</td>
</tr>
</tbody>
</table>
<div class="section" id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-kernels/pyramid_match-0"><table class="bibtex docutils citation" frame="void" id="grauman2007pyramid" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[GD07]</a></td><td>Kristen Grauman and Trevor Darrell. The Pyramid Match Kernel: Efficient Learning with Sets of Features. <em>The Journal of Machine Learning Research</em>, 8:725–760, 2007.</td></tr>
</tbody>
</table>
<table class="bibtex docutils citation" frame="void" id="lazebnik2006beyond" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[LSP06]</a></td><td>Svetlana Lazebnik, Cordelia Schmid, and Jean Ponce. Beyond Bags of Features: Spatial Pyramid Matching for Recognizing Natural Scene Categories. In <em>Proceedings of the 2006 Conference on Computer Vision and Pattern Recognition</em>, volume&nbsp;2, 2169–2178. 2006.</td></tr>
</tbody>
</table>
<table class="bibtex docutils citation" frame="void" id="nikolentzos2017matching" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[NMV17]</a></td><td>Giannis Nikolentzos, Polykarpos Meladianos, and Michalis Vazirgiannis. Matching Node Embeddings for Graph Similarity. In <em>Proceedings of the 31st AAAI Conference on Artificial Intelligence</em>, 2429–2435. 2017.</td></tr>
</tbody>
</table>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="random_walk.html" class="btn btn-neutral float-right" title="Random Walk Kernel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="propagation.html" class="btn btn-neutral float-left" title="Propagation Kernel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, DaSciM (BSD License)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>